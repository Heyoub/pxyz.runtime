# Tasks Domain - Feature PRD (Path/Stack Agnostic)

## Purpose & Scope

The Tasks domain serves as the action management engine of the system. It captures work that needs doing, organizes it across multiple visualization modes, and tracks progress through completion. Unlike rigid task managers that force specific workflows, this domain adapts to how people actually work—supporting everything from quick capture to complex project management, all while participating in the system's circular evolution philosophy.

## Core Philosophy

Tasks are living units of work that evolve based on context. A task isn't just a checkbox—it's a commitment with history, relationships, and potential for transformation. Tasks can spawn workflows, convert to invoices, branch into subtasks, or archive into institutional knowledge. The system makes task management feel like natural thought capture rather than administrative overhead.

## Primary Features

### Task Creation & Quick Capture

- **Frictionless Entry**

- Create tasks from anywhere in the system via Crown command palette
- Quick-add button in Dock creates task without leaving current context
- One-field minimum: just enter what needs doing
- Smart parsing extracts due dates, assignees, and tags from natural language
- Example: "Email Sarah about Q4 project by Friday" auto-fills title, due date, and contact

- **Creation Sources**

- Manual entry via UI
- Converted from emails (preserves thread link)
- Extracted from notes (maintains note context)
- Generated by AI from meeting notes or documents
- Spawned from workflow steps
- Created during wizard flows
- Imported from external systems

- **Smart Defaults**

- Owner defaults to current user
- Due date inferred from context (if mentioned)
- Project/category inherited from active workspace
- Tags suggested based on content and patterns
- Priority estimated from urgency indicators in text

### Task State & Evolution

- **Core States**
Tasks progress through natural lifecycle stages:

- **Idea**: Just captured; not yet actionable
- **Planned**: Scheduled with due date and owner
- **In Progress**: Active work happening
- **Blocked**: Waiting on dependency or external factor
- **Delivered**: Work complete but pending approval/review
- **Follow-Up**: Complete but requires future check-in
- **Done**: Fully complete and archived
- **Cancelled**: No longer needed; reason captured

- **State Transitions**
Moving between states is fluid and context-aware:

- Drag task to different lane in Kanban view changes state
- Change due date triggers re-planning if task in Idea
- Adding blocker description automatically marks Blocked
- Completing task offers delivery confirmation or immediate Done
- Cancelled tasks prompt for reason and alternative actions

- **Circular Evolution**
Tasks participate in system-wide content transformation:

- Task → Workflow: Complex task expands into multi-step workflow
- Task → Invoice: Completed work converts to billable invoice
- Task → Note: Task outcomes archived as knowledge
- Task → Deal: Task represents sales opportunity worth tracking
- Email → Task → Workflow → Invoice (full circular flow)

### Multi-View Visualization

- **Kanban Board View** (Primary)
Visual workflow management with drag-and-drop lanes:

- Lanes represent states (Idea, Planned, In Progress, etc.)
- Cards show task title, owner avatar, due date, priority badge
- Drag cards between lanes to update state
- Swimlanes group by project, owner, or custom criteria
- Card hover reveals quick actions and preview
- Limit work-in-progress per lane (e.g., max 5 in In Progress)
- Color-coding by priority, age, or custom tags

- **List View**
Dense information display for high-volume triage:

- Table format with sortable columns (title, owner, due, priority, state)
- Multi-select for bulk actions
- Inline quick-edit (click field to change)
- Expandable rows reveal subtasks and details
- Filters apply without losing scroll position
- Pagination or infinite scroll for large sets

**Timeline/Gantt View**
Time-based visualization for project planning:

- Tasks plotted on calendar timeline
- Dependencies shown as connecting lines
- Drag to reschedule; resize to adjust duration
- Critical path highlighting
- Milestone markers for key deliverables
- Resource allocation view (who's overloaded)
- Zoom from day-level to month-level granularity

**Priority Grid (Eisenhower Matrix)**
Urgency vs. importance quadrant view:

- Four quadrants: Urgent/Important, Urgent/Not Important, Not Urgent/Important, Neither
- Auto-placement based on due date and tags
- Manual override for misclassified tasks
- Focus mode highlights top quadrant
- Batch actions per quadrant

**My Day / Today View**
Focused single-day planning:

- Tasks due today or manually added to My Day
- Simple checklist format for focus
- Time-blocking suggestions
- Carry-over incomplete tasks to tomorrow
- End-of-day review ritual

### Task Organization & Grouping

**Projects & Categories**
Logical groupings for related work:

- Tasks belong to projects (optional)
- Projects belong to categories (Operations, Pipeline, Work Order, Marketing)
- Hierarchical structure: Category > Project > Task
- Views filterable by project or category
- Project progress roll-up (% complete)

**Tags & Labels**
Flexible categorization beyond hierarchy:

- Freeform tags (user-created)
- Suggested tags based on AI content analysis
- Tag hierarchies (Client Work > Acme Corp > Website Redesign)
- Color-coded for quick visual scanning
- Multi-tag support (one task, many tags)
- Tag-based smart lists

**Custom Fields**
Extensible metadata for specialized workflows:

- Admin-defined fields per workspace
- Field types: text, number, date, dropdown, checkbox
- Conditional visibility based on category or project
- Bulk edit custom fields
- Filter and sort by custom fields

### Dependencies & Relationships

**Task Dependencies**
Model complex workflows with task relationships:

- Blocker tasks must complete before dependent tasks can start
- Visual dependency chains in Timeline view
- Auto-update dependent task state when blocker clears
- Circular dependency detection with warnings
- Multiple blockers supported (all must clear)

**Subtasks & Hierarchy**
Break complex tasks into manageable pieces:

- Unlimited nesting depth (though best practice is 2-3 levels)
- Parent task progress rolls up from subtasks
- Subtasks inherit project, category, tags unless overridden
- Complete parent completes all subtasks (with confirmation)
- Promote subtask to standalone task

**Related Objects**
Tasks link bidirectionally to other system entities:

- Contacts: assigned to or about specific people
- Deals: tasks tied to sales opportunities
- Documents: deliverables or reference materials
- Emails: originated from or require email follow-up
- Workflows: task is step in larger process
- Invoices: task completion triggers billing

### Task Details & Metadata

- **Core Attributes**

- Title (required): what needs doing
- Description: details, context, instructions
- Owner (required): who's responsible
- Due date: when work should complete
- Start date: when work can begin (optional)
- Estimated duration: time required
- Priority: Low, Medium, High, Urgent
- State: lifecycle stage (Idea, Planned, etc.)
- Project/Category: organizational grouping

- **Enriched Context**

- Attachments: files relevant to task
- Comments: threaded discussion about task
- Activity log: full history of changes
- Time tracking: actual hours worked
- Completion notes: what happened, outcomes
- Related tasks: similar or connected work

- **AI-Generated Insights**

- Suggested due dates based on urgency signals
- Recommended owner based on skills or availability
- Blockers detected from description text
- Subtask breakdown proposals
- Priority scoring based on dependencies and impact

### Bulk Actions & Automation

**Multi-Select Operations**
Efficient batch processing:

- Select multiple tasks via checkboxes
- Bulk change owner, due date, project, tags, state
- Bulk delete, archive, or move
- Export selection to CSV
- Create workflow from selected tasks

**Automation Rules**
Admin-configurable task automation:

- Auto-assign tasks based on keywords or project
- Auto-tag based on title patterns
- Auto-escalate overdue tasks
- Recurring task generation (daily standup, weekly review)
- State transitions on date triggers

**Template Tasks**
Reusable task patterns:

- Save task with subtasks as template
- Apply template creates full task structure
- Variables for personalization (client name, project date)
- Team-shared templates
- Version history for templates

### Notifications & Reminders

**Proactive Alerts**
System notifies users of task-related events:

- Task assigned to you
- Task due soon (configurable threshold)
- Task overdue
- Blocked task unblocked
- Comment added to your task
- Mentioned in task description or comment

-**Quiet Hours & Preferences**

- Configurable notification schedule
- Digest mode (daily summary vs. real-time)
- Per-notification-type preferences
- Snooze notifications temporarily
- Do Not Disturb mode

- **In-App Indicators**

- Badge counts on task views
- Visual glows on overdue or urgent tasks
- Persistent notification shelf
- Toast notifications for time-sensitive items

### Search & Smart Lists

**Unified Search**
Crown command palette provides instant task lookup:

- Natural language: "my tasks due this week"
- Property filters: `owner:@me priority:high`
- Keyword search in title, description, comments
- Tag-based search: `tag:client-work`
- Boolean logic: "urgent AND (Sarah OR David)"

**Smart Lists**
Dynamic task collections with auto-membership:

- "Overdue tasks" (due date passed, state not Done)
- "Blocked tasks waiting on me"
- "My tasks due this week"
- "Unassigned tasks" (no owner)
- "High-value tasks" (linked to top deals)

**Custom Filters**
Build and save personalized task views:

- Combine any properties (owner, due, project, state, tags)
- AND/OR logic support
- Save with name for quick access
- Share filters with team
- Subscribe for digest updates when filter membership changes

### Time Tracking & Estimation

**Effort Estimation**
Predict task duration for planning:

- Estimated hours or days field
- AI suggestions based on similar tasks
- Roll-up estimates for projects
- Capacity planning against team availability

**Actual Time Tracking**
Capture work performed:

- Start/stop timer for active task
- Manual time entry
- Time log entries with notes
- Compare estimate vs. actual
- Export time data for billing

**Velocity Metrics**
Team and individual productivity insights:

- Tasks completed per time period
- Average task completion time
- Estimation accuracy (estimate vs. actual)
- Throughput trends over time

### Collaboration & Comments

**Task Comments**
Threaded discussion on task details:

- @mention team members for attention
- Attach files to comments
- Mark comments as resolved
- Comment reactions (emoji)
- Sort by newest or threaded

**Activity Stream**
Transparent change log:

- Who changed what and when
- State transitions visible
- Assignee changes tracked
- Comment activity shown
- Linked object changes reflected

**Delegation & Handoff**
Transfer task ownership smoothly:

- Reassign owner with context note
- Previous owner retains visibility unless restricted
- Notification to new owner
- Handoff history preserved

### Recurrence & Repetition

**Recurring Tasks**
Automate repetitive work:

- Frequency: daily, weekly, monthly, custom interval
- End conditions: after N occurrences, by date, or never
- Next occurrence auto-creates when current completes
- Skip or postpone individual occurrences
- Modify recurrence pattern anytime

**Template-Based Repetition**
Checklists that regenerate:

- Weekly review task with same subtasks
- Monthly reporting task with document template
- Quarterly planning task with stakeholder list
- Variable substitution for personalization

### Mobile & Offline Experience

- **Mobile-Optimized Views**

- Swipe gestures: left to complete, right to snooze
- Bottom action bar for primary actions
- Tap-to-edit inline
- Voice input for quick capture
- Offline task creation and state changes

- **Offline Sync**

- Local cache of recently viewed tasks
- Queue changes when offline
- Conflict resolution on reconnect
- Clear offline indicator

- **Quick Capture Widget**

- Add task from device home screen
- Voice-to-task via Siri/Google Assistant
- Share-to-task from other apps

## User Journeys

### Journey: Quick Task Capture

1. User reading email from client with project request
2. Hits keyboard shortcut (Cmd+K) to open Crown
3. Types: "Build proposal for Acme project by Friday"
4. System parses: title="Build proposal for Acme project", due="Friday", contact="Acme"
5. User hits Enter; task created
6. Returns to email without context loss
7. Task appears in My Day and Acme project views

### Journey: Kanban Workflow Management

1. User opens Tasks in Kanban view
2. Five "Planned" tasks need prioritization
3. Drags "Website redesign" to "In Progress" lane
4. Card updates state; moves to lane
5. Drags "Logo concepts" from "Idea" to "Planned"; assigns to designer
6. Designer receives notification
7. Limits work-in-progress: system warns when In Progress lane hits 5 tasks

### Journey: Complex Task Breakdown

1. User has task "Launch new product"
2. Task feels overwhelming; clicks "Generate Subtasks"
3. AI suggests 8 subtasks: market research, feature spec, design, development, etc.
4. User reviews, edits, approves
5. Subtasks created under parent
6. User assigns subtasks to team members
7. Parent task progress auto-updates as subtasks complete

### Journey: Blocked Task Management

1. Task "Send contract" blocked waiting on legal review
2. User marks task as Blocked; adds blocker note: "Waiting on legal to approve terms"
3. Task moves to Blocked lane; visual indicator added
4. Legal approves contract; user unblocks task
5. Task returns to In Progress
6. User receives notification that blocker cleared

### Journey: Task to Invoice Evolution

1. User completes task "Q4 website updates" for client
2. Marks task as Done
3. System detects task linked to billable project
4. Prompt: "Generate invoice for this work?"
5. User confirms
6. Invoice draft created with task details as line item
7. User reviews, adjusts pricing, sends invoice

## State & Data Model (Conceptual)

### Task Entity

- Unique identifier
- Title (required)
- Description (rich text)
- Owner (user reference)
- State (enum: Idea, Planned, In Progress, Blocked, Delivered, Done, Cancelled)
- Priority (Low, Medium, High, Urgent)
- Due date (optional)
- Start date (optional)
- Estimated duration
- Actual time tracked
- Project/category references
- Tags (array)
- Custom fields (key-value pairs)
- Parent task (for subtasks)
- Dependencies (array of blocker task IDs)
- Linked objects (contacts, emails, documents, deals)
- Attachments
- Timestamps (created, modified, completed)
- Metadata (source, how created)

### Recurring Task Config

- Recurrence pattern (daily, weekly, monthly, custom)
- Interval (every N days/weeks/months)
- End condition (date, count, never)
- Next occurrence date
- Original template

### Comments

- Comment identifier
- Task reference
- Author
- Content (text, mentions, attachments)
- Parent comment (for threading)
- Resolved status
- Timestamp

### Activity Log Entry

- Event type (created, state_changed, assigned, commented, etc.)
- Actor (user who performed action)
- Timestamp
- Change details (before/after values)
- Context (IP, device, etc.)

## Integration Points

### With Contacts Domain

- Assign tasks to specific contacts
- View all tasks related to contact
- Task completion updates contact timeline
- Contact creation from task mentions

### With Email Domain

- Create tasks from emails
- Link tasks to email threads
- Task completion can trigger reply
- Email notifications for task updates

### With Workflows Domain

- Tasks represent workflow steps
- Workflow completion generates tasks
- Task state changes advance workflows
- Dependencies modeled between workflow tasks

### With Invoices Domain

- Completed tasks convert to invoice line items
- Time tracking data flows to invoices
- Billable flag on tasks
- Invoice generation from task sets

### With Documents Domain

- Attach documents to tasks
- Generate documents from task completion
- Task deliverables stored as documents
- Document approval tasks

### With Calendar Domain

- Tasks with due dates appear in calendar
- Time-blocked tasks reserve calendar slots
- Meeting-generated tasks link to events

### With Client Portal

- Client-visible tasks for project transparency
- Client approval tasks for reviews
- Portal activity creates internal tasks
- Client uploads trigger task creation

### With AI Copilot

- AI suggests task breakdowns
- Detects blockers from descriptions
- Recommends due dates and owners
- Generates task summaries
- Predicts task duration
- Identifies related tasks

## UX Principles Specific to Tasks

### Capture Over Organize

Make it trivial to create tasks; defer organization. Get it out of your head first.

### Progressive Disclosure

Show minimal fields on creation; expand details as task matures and needs more structure.

### View Flexibility

Support multiple visualization modes; let users choose how they think about their work.

### Keyboard-First

Power users should fly through task management with keyboard shortcuts for all common actions.

### State Over Status

Use natural lifecycle stages (Idea, In Progress, Done) rather than arbitrary status labels.

### AI as Coach

AI should suggest improvements (add blocker, break into subtasks) without being intrusive.

### Mobile Parity

Task creation and basic management must be fully functional on mobile with offline support.

## Edge Cases & Safety Nets

### Accidental Deletion

- Soft-delete with recovery window
- Undo immediately after delete
- Archive vs. delete distinction
- Warn if deleting tasks with subtasks or dependencies

### Circular Dependencies

- Detect dependency loops before creation
- Warn user and suggest resolution
- Block circular dependency creation

### Overdue Task Handling

- Configurable auto-escalation
- Reschedule suggestions
- Option to mark as cancelled if no longer relevant

### Bulk Action Confirmation

- Preview changes before applying bulk actions
- Undo window for bulk changes
- Progress indicator for large operations

### Conflict Resolution

- Last-write-wins for simple fields
- Merge comments and activity log
- Highlight conflicts for user resolution

### Access Control

- Task visibility based on project permissions
- Private tasks visible only to owner
- Team tasks visible to all team members
- Client portal tasks filtered for client view

## Success Metrics

- Tasks created per user per week
- Task completion rate
- Time from creation to completion
- Estimation accuracy (estimate vs. actual time)
- Overdue task rate (should decrease)
- Usage of different views (which are most popular)
- AI suggestion acceptance rate
- Mobile vs. desktop task creation ratio

## Conclusion

The Tasks domain transforms work management from administrative burden into natural thought capture and progress tracking. By supporting multiple views, enabling circular evolution, and integrating deeply with the rest of the system, it meets users wherever they are in their workflow—whether they're quickly jotting down an idea or managing a complex multi-person project. The AI assistance ensures tasks don't fall through the cracks while keeping the user in full control.
